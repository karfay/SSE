package ug.action;

import java.util.List;

import javax.annotation.Resource;

import org.seasar.extension.jdbc.JdbcManager;
import org.seasar.struts.annotation.ActionForm;
import org.seasar.struts.annotation.Execute;

import ug.SqlFiles;
import ug.condition.UkListCondition;
import ug.dto.UkListDto;
import ug.dto.UserDataDto;
import ug.form.UkListForm;

public class UkListAction {

	@ActionForm
	@Resource
	protected UkListForm ukListForm;

	@Resource
	protected UserDataDto userDataDto;

	@Resource
	protected JdbcManager jdbcManager;

	public List<UkListDto> ukList;

	/**
	 * 初期表示
	 * @return
	 */
	@Execute(validator=false)
	public String index(){
		//TODO とりあえず権限付与 あとで消す
		userDataDto.ukUpdate = "1";
		//ukListCondition.nendo = ug.util.StringUtil.getCurrentNendo();
		ukListForm.searchNendo = ug.util.StringUtil.getCurrentNendo();
		UkListCondition ukListCondition = new UkListCondition();
		refillCondition(ukListForm, ukListCondition);
		ukList = jdbcManager.selectBySqlFile(UkListDto.class, SqlFiles.searchUkList, ukListCondition).getResultList();
		return "list.jsp";
	}

	/**
	 * 「検索」ボタン押下時
	 * @return
	 */
	@Execute(input="index")
	public String search(){
		return "list.jsp";
	}

	/**
	 * 「新規作成」ボタン押下時
	 * @return
	 */
	@Execute(input="index")
	public String newCreate(){
		return "list.jsp";
	}

	/**
	 * 「更新」ボタン押下時
	 * @return
	 */
	@Execute(input="index")
	public String update(){
		return "list.jsp";
	}

	/**
	 * 「削除」ボタン押下時
	 * @return
	 */
	@Execute(input="index")
	public String delete(){
		return "list.jsp";
	}

	/**
	 * 「失注削除」ボタン押下時
	 * @return
	 */
	@Execute(input="index")
	public String sittyu(){
		return "list.jsp";
	}

	/**
	 * formで受け取った検索条件をconditionに詰め替えるメソッド
	 * @param form
	 * @param condition
	 */
	private void refillCondition(UkListForm form, UkListCondition condition){
		condition.tounendo = form.searchNendo;
		condition.jinendo = String.valueOf(Integer.parseInt(form.searchNendo)+1);
		condition.zennendo = String.valueOf(Integer.parseInt(form.searchNendo)-1);
		condition.kokyakuName = form.searchKokyakuName;
		condition.ankenName = form.searchAnkenName;
		condition.jutyuName = form.searchJutyuName;
		condition.kakudoList = form.searchKakudoList;
		condition.hattyuTypeList = form.searchHattyuTypeList;
		condition.eigyoList = form.searchEigyoList;
		condition.conditionCodeList = form.searchConditionCodeList;
		condition.sort = form.searchSort;
	}
}
