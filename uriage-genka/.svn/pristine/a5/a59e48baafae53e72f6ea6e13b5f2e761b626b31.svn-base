<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css" href="${f:url('/css/global.css')}"></link>

<style type="text/css">
div.hide-input-form{padding-left:15px;}
div.input-form{
	background-color:#f8e58c;
	width:100%;
	left:0;
	padding:5px 30px;
}
div.input-form table{background-color: transparent; border: none; padding-top: 5px;}
div.input-form th{width: 100px;}
div.input-form td{width: 100px;}
div.input-form font{font-weight:bold;}
input[type="text"]{width:100px;}
div.list-header{position: fixed; z-index: 9999; width:2000px;}
div.list-body{position: absolute; width: 2000px;}
table.theme-list{
	table-layout: fixed;
	border-collapse: collapse;
	border: solid thin black;
}
.theme-no{width: 100px;}
.theme-group{width: 100px;}
.name{width: 300px;}
.other{width: 50px}
.limited-auth{width: 50px}
.date{width: 100px;}
.money{width: 100px;}
.percentage{width: 75px;}
</style>

<script type="text/javascript" src="${f:url('/javascript/checkDatePattern.js')}"></script>
<script type="text/javascript" src="${f:url('/javascript/jquery-3.1.1.min.js')}"></script>

<script type="text/javascript">
function executeClear(){

	$(".input-table").find("input, select").each(function(){
		$(this).val("");
	});

	if(orgRow!=null){
		if(orgRow % 2 == 0)document.getElementById(orgRow).className='row1';
		else document.getElementById(orgRow).className='row2';
	}
	//window.alert('入力フォームをクリアしました。');
	return false;
}

function checkInsert(){
	var input = document.forms["input"];
	if(input.nendo.value==''){
		window.alert('年度は必須です。');
		return false;
	}
	if(input.eigyo.value==''){
		window.alert('担当は必須です。');
		return false;
	}
	if(input.ankenName.value==''){
		window.alert('案件名は必須です。');
		return false;
	}
	if(input.kokyakuName.value==''){
		window.alert('顧客名は必須です。');
		return false;
	}
	if(input.kokyakuInitial.value==''){
		window.alert('イニシャルは必須です。');
		return false;
	}
	if(input.hattyuTypeCode.value==''){
		window.alert('発注タイプは必須です。');
		return false;
	}
	if(input.hattyuMikomiDate.value==''){
		window.alert('受注見込時期は必須です。');
		return false;
	}
	if(input.kakudoCode.value==''){
		window.alert('状況は必須です。');
		return false;
	}
	if(input.jutyugaku.value==''){
		window.alert('受注額は必須です。');
		return false;
	}
	return confirm('入力した内容で新規作成します');
}

function checkUpdate(){
	if(checkQuote() == false)return false;
	else return window.confirm('更新して良いですか？');
}

function checkDelete(){
	if(checkQuote() == false)return false;
	else return window.confirm('削除して良いですか？');
}

function checkQuote(){
	if(document.forms["input"].ankenId.value == ''){
		window.alert('対象が選択されていません');
		return false;
	} else return true;
}

function executeQuote(obj){
	var input = document.forms["input"];
	//input.nendo.value = $.trim($("#"+index).children("#nendo").text());

	input.ankenId.value = obj.form.ankenId.value;
	input.ankenRirekiNo.value = obj.form.ankenRirekiNo.value;
	input.ankenRirekiId.value = obj.form.ankenRirekiId.value;
	input.nendo.value = obj.form.nendo.value;
	input.kokyakuName.value = obj.form.kokyakuName.value;
	input.kokyakuInitial.value = obj.form.kokyakuInitial.value;
	input.ankenName.value = obj.form.ankenName.value;
	input.jutyuName.value = obj.form.jutyuName.value;
	input.themeNo.value = obj.form.themeNo.value;
	input.themeGroup.value = obj.form.themeGroup.value;
	input.kaihatsuGroupHead.value = obj.form.kaihatsuGroupHead.value;
	//input.kaihatsuGroupHeadName.value = obj.form.kaihatsuGroupHeadName.value;
	input.eigyo.value = obj.form.eigyo.value;
	//input.eigyoName.value = obj.form.eigyoName.value;
	input.hattyuTypeCode.value = obj.form.hattyuTypeCode.value;
	//input.hattyuTypeName.value = obj.form.hattyuTypeName.value;
	input.kakudoCode.value = obj.form.kakudoCode.value;
	//input.kakudoName.value = obj.form.kakudoName.value;
	input.hattyuMikomiDate.value = obj.form.hattyuMikomiDate.value;
	input.hattyuDate.value = obj.form.hattyuDate.value;
	input.kensyuDate.value = obj.form.kensyuDate.value;
	//input.notes.value = obj.form.notes.value;
	//金額のみ3桁区切り数値に変換
	input.jutyugaku.value = Number(obj.form.jutyugaku.value).toLocaleString();
	input.ukYokuyoku.value = Number(obj.form.ukYokuyoku.value).toLocaleString();
	input.ukConditionCode.value = obj.form.ukConditionCode.value;
	//input.insertDate.value = obj.form.insertDate.value;
	//input.insertEmpNo.value = obj.form.insertEmpNo.value;

	input.tounendoApr.value = Number(obj.form.tounendoApr.value).toLocaleString();
	input.tounendoMay.value = Number(obj.form.tounendoMay.value).toLocaleString();
	input.tounendoJun.value = Number(obj.form.tounendoJun.value).toLocaleString();
	input.tounendoJul.value = Number(obj.form.tounendoJul.value).toLocaleString();
	input.tounendoAug.value = Number(obj.form.tounendoAug.value).toLocaleString();
	input.tounendoSep.value = Number(obj.form.tounendoSep.value).toLocaleString();
	input.tounendoOct.value = Number(obj.form.tounendoOct.value).toLocaleString();
	input.tounendoNov.value = Number(obj.form.tounendoNov.value).toLocaleString();
	input.tounendoDec.value = Number(obj.form.tounendoDec.value).toLocaleString();
	input.tounendoJan.value = Number(obj.form.tounendoJan.value).toLocaleString();
	input.tounendoFeb.value = Number(obj.form.tounendoFeb.value).toLocaleString();
	input.tounendoMar.value = Number(obj.form.tounendoMar.value).toLocaleString();
	input.jinendoApr.value = Number(obj.form.jinendoApr.value).toLocaleString();
	input.jinendoMay.value = Number(obj.form.jinendoMay.value).toLocaleString();
	input.jinendoJun.value = Number(obj.form.jinendoJun.value).toLocaleString();
	input.jinendoJul.value = Number(obj.form.jinendoJul.value).toLocaleString();
	input.jinendoAug.value = Number(obj.form.jinendoAug.value).toLocaleString();
	input.jinendoSep.value = Number(obj.form.jinendoSep.value).toLocaleString();
	input.jinendoOct.value = Number(obj.form.jinendoOct.value).toLocaleString();
	input.jinendoNov.value = Number(obj.form.jinendoNov.value).toLocaleString();
	input.jinendoDec.value = Number(obj.form.jinendoDec.value).toLocaleString();
	input.jinendoJan.value = Number(obj.form.jinendoJan.value).toLocaleString();
	input.jinendoFeb.value = Number(obj.form.jinendoFeb.value).toLocaleString();
	input.jinendoMar.value = Number(obj.form.jinendoMar.value).toLocaleString();
	input.tounendoKamiki.value = Number(obj.form.tounendoKamiki.value).toLocaleString();
	input.tounendoShimoki.value = Number(obj.form.tounendoShimoki.value).toLocaleString();
	input.tounendoTotal.value = Number(obj.form.tounendoTotal.value).toLocaleString();
	input.jinendoKamiki.value = Number(obj.form.jinendoKamiki.value).toLocaleString();
	input.jinendoShimoki.value = Number(obj.form.jinendoShimoki.value).toLocaleString();
	input.jinendoTotal.value = Number(obj.form.jinendoTotal.value).toLocaleString();
	input.zennendoTotal.value = Number(obj.form.zennendoTotal.value).toLocaleString();
	//	console.log("quote successful");
	//window.alert('入力フォームに値を転記しました。');
	return false;
}

//もとのスタイルをorgRowに保存して、selectedに変える。
//色替え処理は色々スタイルをいじった後、最後に行いたい処理なので、
//背景色のみを変える処理でも良いかもしれない。
//引数のrowはリスト<th>タグのidにインデックスを設定することで利用可能。
//row1はリストの偶数行、row2は奇数行、selectedは選択中の行のクラス。
var orgRow;
function changeColor(row){
	if(orgRow!=null){
		if(orgRow % 2 == 0)document.getElementById(orgRow).className='row1';
		else document.getElementById(orgRow).className='row2';
	}
	orgRow = row;
	document.getElementById(row).className='selected';
}

//テーマNOの検証を行う。フォーカスが外れた時（onblur）に使用する。
//テーマNOにふさわしい文字列でない場合、入力を空白に戻す。
//また、正しい値が入力されたときテーマ親番の自動採番を行う。
function checkThemeNo(){
	str = document.forms["input"].themeNo.value;
	if(str == '')return;
	if(str.match(/^[0-9]{9}$/)){
		str = str.substring(0,5)+'-'+str.substring(5,9);
		document.forms["input"].themeNo.value = str;
	}
	if(str.match(/^[0-9]{5}-[0-9]{4}$/)){
	//テーマ親番の自動採番
		if(document.forms["input"].themeGroup.value==''){
			document.forms["input"].themeGroup.value = str.substring(0,9)
		}
	}else{
		window.alert('テーマNOに相応しくありません。入力し直して下さい。');
		document.forms["input"].themeNo.value = '';
		document.forms["input"].themeNo.focus();
	}
}

function checkThemeGroup(){
	str = document.forms["input"].themeGroup.value;
	if(str == '')return;

	//売上計画管理表のみの特別な判定
	if(document.forms["input"].themeNo.value==""){
		window.alert('テーマNOが未入力の時、テーマ親番は入力できません。');
		document.forms["input"].themeGroup.value = '';
		document.forms["input"].themeGroup.focus();
		return;
	}

	if(str.match(/^[0-9]{8}$/)){
		str = str.substring(0,5)+'-'+str.substring(5,8);
		document.forms["input"].themeGroup.value = str;
	}
	if(str.match(/[0-9]{5}-[0-9]{3}/))return;

	window.alert('テーマ親番に相応しくありません。入力し直して下さい。');
	document.forms["input"].themeGroup.value = '';
	document.forms["input"].themeGroup.focus();
}

document.onkeydown = KeyEvent;
function KeyEvent(e){
    var pressKey=event.keyCode;
    if(pressKey == 13) {
	return false;
    }
}

//金額チェック
//空白なら"0"に差し替え
//入力文字列のカンマを削除して、0以上の整数なら3桁カンマ区切りに再フォーマット
//そうでない場合はエラーメッセージを出して入力を"0"に差し替え
function checkMoney(obj){
	str = obj.value;
	if(str==''){
		obj.value="0"
		return;
	}
	number = Number(str.replace(/,/g,""));
	if(isInteger(number)==true && number >= 0){
		obj.value=number.toLocaleString();
		return;
	}
	window.alert('金額は自然数でなければいけません。入力し直して下さい。');
	obj.value='0';

	function isInteger(x) {
	    return Math.round(x) === x;
	}
/*
	 > isInteger(1)
	true
	> isInteger(0)
	true
	> isInteger(1.111)
	false
	> isInteger("1")
	false
	> isInteger("")
	false
	> isInteger(null)
	false
	> isInteger(NaN)
	false
	> isInteger(undefined)
	false
 */
 }

function checkParcentage(obj){
	str = obj.value;
	if(str=='')return;
	if(str.match(/^[0-9]{2}.[0-9]$/))return;
	number = Number(str);
	if(isInteger(number)==true && (number>=0 && number<=100)){
		obj.value = number.toFixed(1);
		return;
	}
	window.alert('百分率でなければいけません。入力し直して下さい。\n【受け付ける数値例】30,100,65.5');
	obj.value='';

	function isInteger(x) {
	    return Math.round(x) === x;
	}
}

function hideDiv(divId, obj){
	if(obj.value=='非表示'){
		obj.value='表示';
		document.getElementById(divId).style.display='none';
	}else{
		obj.value='非表示';
		document.getElementById(divId).style.display='block';
	}
	initializeUnfixedHeight();
}

function initializeUnfixedHeight(){
	if(${empty themeInsert}){
		console.log('no authorization');
	}

	$('div.fixed').css('top', $('div.header').height());
	$('div.list-header').css('top', $('div.header').height()+$('div.fixed').height());
	$('div.list-body').css('top', $('div.header').height()+ $('div.fixed').height()+ $('div.list-header').height());
}

//var listHeader = $('div#list-header');
window.addEventListener('scroll', _hangleScroll, false);
function _hangleScroll(){
	$('div#list-header').css('left',  - window.scrollX + 8);
	//console.log($('div#list-header').css('left'));
}

//list-bodyの<td class="keyClass">を順次チェックして、newInsertまたはnewUpdateに該当するものがあったら列の色を変える。
//keyClassクラスはその列で一意のクラスでなければならない。text()で複数の要素をまとめて取り出してしまうため。
//対象が複数であっても問題なく色が変わる。ただし対象は列ごと。
function changeExecuteRowColor(keyClass){
	$('.list-body tr').each(function(){
		//keyClass = 'theme-no';
		//console.log('check');
		if($.trim($(this).children('td.'+keyClass).text()) == '${newInsert}'){
			$(this).css('border','solid 2px red');//2px以上にすると、別のテーブルのbordarに影響が出る。謎。
		}
		else if($.trim($(this).children('td.'+keyClass).text()) == '${newUpdate}'){
			$(this).css('border','solid 2px aqua');
		}
	});
}

</script>
<title>${pageName}</title>
</head>
<body onload="initializeUnfixedHeight()">

<div class="header" id="header">
${sysName} / ${pageName}
</div>

<div class="fixed" id="fixed">

<c:if test="${!empty errMessage}">
	<div class="error">
	${errMessage}
	</div>
</c:if>

<html:errors/>

<c:if test="${!empty sysMessage}">
	<div class="message">
	${sysMessage}
	</div>
</c:if>
</div>

<s:form styleId="input">

<div id="input-form" style="padding-top: 24px; width: 3000px;">

	<table class="input-table">

		<%-- ankenId,ankenRirekiId,ankenRirekiNo,ukConditionCodeを選択ボタンから受けるhidden --%>
		<html:hidden property="ankenId" value="${ankenId }" />
		<html:hidden property="ankenRirekiId" value="${ankenRirekiId }" />
		<html:hidden property="ankenRirekiNo" value="${ankenRirekiNo }" />
		<html:hidden property="ukConditionCode" value="${ukConditionCode }" />

		<tr>
			<th>年度</th>
			<th>担当</th>
			<th colspan="4">案　件　名</th>
			<th colspan="4">受　注　品　名</th>
			<th>テーマ親番</th>
			<th>テーマNO</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td><html:text property="nendo" styleClass="required" errorStyleClass="error" onblur="checkNendo(this)" /></td>
			<td><html:select property="eigyo" styleClass="required" errorStyleClass="error" value="${eigyo}" >
				<c:forEach var="el" items="${eigyoList}">
					<html:option value="${el.empNo}">${el.shortEmpName}</html:option>
				</c:forEach>
			</html:select></td>
			<td colspan="4"><html:text property="ankenName" styleClass="required" errorStyleClass="error" /></td>
			<td colspan="4"><html:text property="jutyuName" /></td>
			<td><html:text property="themeGroup" onblur="checkThemeGroup()" /></td>
			<td><html:text property="themeNo" onblur="checkThemeNo()" /></td>
		</tr>
		<tr>
			<th>開発G</th>
			<th>顧客名</th>
			<th>イニシャル</th>
			<th>発注タイプ</th>
			<th>受注見込時期</th>
			<th>発注日</th>
			<th>検収日</th>
			<th>状況</th>
			<th>受注額</th>
			<th>売上計</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td><html:select property="kaihatsuGroupHead" value="${kaihatsuGroupHead}" >
					<html:option value=""></html:option>
				<c:forEach var="el" items="${kaihatsuGroupList}">
					<html:option value="${el.empNo}">${el.shortEmpName}</html:option>
				</c:forEach>
			</html:select></td>
			<td><html:text property="kokyakuName" styleClass="required" errorStyleClass="error" /></td>
			<td><html:text property="kokyakuInitial" styleClass="required" errorStyleClass="error" /></td>
			<td><html:select property="hattyuTypeCode" styleClass="required" errorStyleClass="error" value="${hattyuTypeCode}" >
				<c:forEach var="el" items="${hattyuTypeList}">
					<html:option value="${el.codeId}">${el.codeName}</html:option>
				</c:forEach>
			</html:select></td>
			<td><html:text property="hattyuMikomiDate" styleClass="required" errorStyleClass="error" /></td>
			<td><html:text property="hattyuDate" /></td>
			<td><html:text property="kensyuDate" /></td>
			<td><html:select property="kakudoCode" styleClass="required" errorStyleClass="error" value="${kakudoCode}" >
				<c:forEach var="el" items="${kakudoList}">
					<html:option value="${el.codeId}">${el.codeName}</html:option>
				</c:forEach>
			</html:select></td>
			<td><html:text property="jutyugaku" styleClass="required" errorStyleClass="error" /></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td>４月</td>
			<td>５月</td>
			<td>６月</td>
			<td>７月</td>
			<td>８月</td>
			<td>９月</td>
			<th>上期</th>
			<td>１０月</td>
			<td>１１月</td>
			<td>１２月</td>
			<td>１月</td>
			<td>２月</td>
			<td>３月</td>
			<th>下期</th>
			<th>年度計</th>
			<th>翌々年度以降</th>
		</tr>
		<tr>
			<th>${searchNendo}年度</th>
			<td><html:text property="tounendoApr" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoMay" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoJun" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoJul" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoAug" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoSep" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoKamiki" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoOct" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoNov" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoDec" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoJan" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoFeb" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoMar" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoShimoki" onblur="checkMoney(this)" /></td>
			<td><html:text property="tounendoTotal" onblur="checkMoney(this)" /></td>
			<th>売上計画</th>
		</tr>
		<tr>
			<th>${searchNendo+1}年度</th>
			<td><html:text property="jinendoApr" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoMay" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoJun" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoJul" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoAug" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoSep" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoKamiki" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoOct" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoNov" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoDec" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoJan" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoFeb" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoMar" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoShimoki" onblur="checkMoney(this)" /></td>
			<td><html:text property="jinendoTotal" onblur="checkMoney(this)" /></td>
			<td><html:text property="ukYokuyoku" onblur="checkMoney(this)" /></td>
		</tr>
	</table>
		<input type="submit" onclick="return checkInsert()" name="newCreate" value="新規作成" class="insert" />
		<input type="submit" onclick="return checkUpdate()" name="update" value="更新" class="update" />
		<input type="submit" onclick="return checkDelete()" name="delete" value="削除" class="delete" />
		<input type="submit" onclick="return checkDelete()" name="sittyu" value="失注削除" class="delete" />
		<input type="button" onclick="return executeClear()" value="クリア" class="normal" />

</div>

<div id="search-form" >

<table>
	<tr>
		<td>年度</td>
		<td><html:select property="searchNendo" value="${searchNendo }">
			<c:forEach var="nl" items="${nendoList }">
				<html:option value="${nl }">${nl }</html:option>
			</c:forEach>
		</html:select></td>
		<td></td>
		<td>顧客名</td>
		<td colspan="2"><html:text property="searchKokyakuName" value="${f:h(searchKokyakuName)}"></html:text></td>
		<td></td>
		<td>ソート</td>
<%--
		<td><input type="radio" name="searchSort" value="nomal">通常</td>
		<td><input type="radio" name="searchSort" value="themeNo">テーマNO</td>
--%>
		<td><html:radio property="searchSort" value="normal" />通常</td>
		<td><html:radio property="searchSort" value="themeNo" />テーマNO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>案件名</td>
		<td colspan="5"><html:text property="searchAnkenName" value="${f:h(searchAnkenName) }"></html:text></td>
		<td></td>
		<td>受注品名</td>
		<td colspan="5"><html:text property="searchJutyuName" value="${f:h(searchJutyuName) }"></html:text></td>
	</tr>
	<tr>
		<td>確度</td>
		<c:forEach var="kl" items="${kakudoList }">
			<td><html:checkbox  property="searchKakudoList" value="${kl.codeId }" />${kl.codeName }</td>
		</c:forEach>
	</tr>
	<tr>
		<td>発注タイプ</td>
		<c:forEach var="htl" items="${hattyuTypeList }">
			<td><html:multibox property="searchHattyuTypeList" value="${htl.codeId }" />${htl.codeName }</td>
		</c:forEach>
	</tr>

	<tr>
		<td>担当</td>
		<c:forEach var="el" items="${eigyoList }">
			<td><html:multibox property="searchEigyoList" value="${el.empNo }" />${el.shortEmpName }</td>
		</c:forEach>
		<td colspan="4"></td>
	</tr>
	<tr>
		<td>特殊</td>
		<c:forEach var="ccl" items="${conditionCodeList }">
			<td><html:multibox property="searchConditionCodeList" value="${ccl.codeId }" />${ccl.codeName }</td>
		</c:forEach>
		<td></td>
		<td></td>
	</tr>
</table>
<html:submit property="search" value="検索"></html:submit>
</div>
</s:form>
<div class="list" style="width: 7500px;">
<table id="list-body">
	<tr>
		<th></th>
		<th>年度</th>
		<th>顧客名</th>
		<th>案　件　名</th>
		<th>受注品名</th>
		<th>開発G</th>
		<th>担当</th>
		<th>発注タイプ</th>
		<th>発注見込時期</th>
		<th>発注日</th>
		<th>検収日</th>
		<th>状況</th>
		<th>テーマ親番</th>
		<th>テーマNO</th>
		<th>受注額(円)</th>
		<th>売上計</th>
		<th>４月</th>
		<th>５月</th>
		<th>６月</th>
		<th>７月</th>
		<th>８月</th>
		<th>９月</th>
		<th>上期計</th>
		<th>１０月</th>
		<th>１１月</th>
		<th>１２月</th>
		<th>１月</th>
		<th>２月</th>
		<th>３月</th>
		<th>下期計</th>
		<th>当年度計</th>
		<th>４月</th>
		<th>５月</th>
		<th>６月</th>
		<th>７月</th>
		<th>８月</th>
		<th>９月</th>
		<th>上期計</th>
		<th>１０月</th>
		<th>１１月</th>
		<th>１２月</th>
		<th>１月</th>
		<th>２月</th>
		<th>３月</th>
		<th>下期計</th>
		<th>次年度計</th>
		<th>翌々年度移行売上計画</th>
		<th>備考</th>

	</tr>
	<c:forEach items="${ukList}" var="e" varStatus="s">


		<%-- jqueryでidによる受け渡しも考えたけど、\マークの削除処理とかselectのid受け渡しとかでかえって面倒になった --%>
		<s:form>
		<html:hidden property="ankenId" value="${e.ankenId}" />
		<html:hidden property="ankenRirekiNo" value="${e.ankenRirekiNo}" />
		<html:hidden property="ankenRirekiId" value="${e.ankenRirekiId}" />
		<html:hidden property="nendo" value="${e.nendo}" />
		<html:hidden property="kokyakuName" value="${e.kokyakuName}" />
		<html:hidden property="kokyakuInitial" value="${e.kokyakuInitial}" />
		<html:hidden property="ankenName" value="${e.ankenName}" />
		<html:hidden property="jutyuName" value="${e.jutyuName}" />
		<html:hidden property="themeNo" value="${e.themeNo}" />
		<html:hidden property="themeGroup" value="${e.themeGroup}" />
		<html:hidden property="kaihatsuGroupHead" value="${e.kaihatsuGroupHead}" />
		<html:hidden property="kaihatsuGroupHeadName" value="${e.kaihatsuGroupHeadName}" />
		<html:hidden property="eigyo" value="${e.eigyo}" />
		<html:hidden property="eigyoName" value="${e.eigyoName}" />
		<html:hidden property="hattyuTypeCode" value="${e.hattyuTypeCode}" />
		<html:hidden property="hattyuTypeName" value="${e.hattyuTypeName}" />
		<html:hidden property="kakudoCode" value="${e.kakudoCode}" />
		<html:hidden property="kakudoName" value="${e.kakudoName}" />
		<html:hidden property="hattyuMikomiDate" value="${e.hattyuMikomiDate}" />
		<html:hidden property="hattyuDate" value="${e.hattyuDate}" />
		<html:hidden property="kensyuDate" value="${e.kensyuDate}" />
		<html:hidden property="notes" value="${e.notes}" />
		<html:hidden property="jutyugaku" value="${e.jutyugaku}" />
		<html:hidden property="ukYokuyoku" value="${e.ukYokuyoku}" />
		<html:hidden property="ukConditionCode" value="${e.ukConditionCode}" />
		<html:hidden property="insertDate" value="${e.insertDate}" />
		<html:hidden property="insertEmpNo" value="${e.insertEmpNo}" />
		<html:hidden property="tounendoApr" value="${e.tounendoApr}" />
		<html:hidden property="tounendoMay" value="${e.tounendoMay}" />
		<html:hidden property="tounendoJun" value="${e.tounendoJun}" />
		<html:hidden property="tounendoJul" value="${e.tounendoJul}" />
		<html:hidden property="tounendoAug" value="${e.tounendoAug}" />
		<html:hidden property="tounendoSep" value="${e.tounendoSep}" />
		<html:hidden property="tounendoOct" value="${e.tounendoOct}" />
		<html:hidden property="tounendoNov" value="${e.tounendoNov}" />
		<html:hidden property="tounendoDec" value="${e.tounendoDec}" />
		<html:hidden property="tounendoJan" value="${e.tounendoJan}" />
		<html:hidden property="tounendoFeb" value="${e.tounendoFeb}" />
		<html:hidden property="tounendoMar" value="${e.tounendoMar}" />
		<html:hidden property="jinendoApr" value="${e.jinendoApr}" />
		<html:hidden property="jinendoMay" value="${e.jinendoMay}" />
		<html:hidden property="jinendoJun" value="${e.jinendoJun}" />
		<html:hidden property="jinendoJul" value="${e.jinendoJul}" />
		<html:hidden property="jinendoAug" value="${e.jinendoAug}" />
		<html:hidden property="jinendoSep" value="${e.jinendoSep}" />
		<html:hidden property="jinendoOct" value="${e.jinendoOct}" />
		<html:hidden property="jinendoNov" value="${e.jinendoNov}" />
		<html:hidden property="jinendoDec" value="${e.jinendoDec}" />
		<html:hidden property="jinendoJan" value="${e.jinendoJan}" />
		<html:hidden property="jinendoFeb" value="${e.jinendoFeb}" />
		<html:hidden property="jinendoMar" value="${e.jinendoMar}" />
		<html:hidden property="tounendoKamiki" value="${e.tounendoKamiki}" />
		<html:hidden property="tounendoShimoki" value="${e.tounendoShimoki}" />
		<html:hidden property="tounendoTotal" value="${e.tounendoTotal}" />
		<html:hidden property="jinendoKamiki" value="${e.jinendoKamiki}" />
		<html:hidden property="jinendoShimoki" value="${e.jinendoShimoki}" />
		<html:hidden property="jinendoTotal" value="${e.jinendoTotal}" />
		<html:hidden property="zennendoTotal" value="${e.zennendoTotal}" />



		<tr class="${s.index %2 == 0 ? 'row1' : 'row2'}" id="${s.index}">
		<%--
				<c:if test="${!empty ukUpdate}">
					<td id="${s.index}X1" class="limited-auth"><input type="button" value="選択" onclick="changeColor(${s.index});executeQuote(this);" class="select" /></td>
				</c:if>

		 <td id="${s.index}X1" class="limited-auth"><input type="button" value="選択" onclick="changeColor(${s.index});executeQuote(this);" class="select" /></td>
		 --%>
		 <td id="select-button" class="limited-auth"><input type="button" value="選択" onclick="changeColor(${s.index});executeQuote(this);" class="select" /></td>
				<td id="nendo" class="nendo" style="text-align: center;">
					${f:h(e.nendo) }
				</td>
				<td id="kokyaku-name" class="kokyaku-name" style="text-align: left; padding-left: 5px;">
					${f:h(e.kokyakuInitial)}  ${f:h(e.kokyakuName)}
				</td>
				<td id="anken-name" class="anken-name" style="text-align: left; padding-left: 5px;">
					${f:h(e.ankenName)}
				</td>
				<td id="jutyu-name" class="jutyu-name" style="text-align: left; padding-left: 5px;">
					${f:h(e.jutyuName)}
				</td>
				<td id="kaihatsu-group-head-name" class="short-emp-name" style="text-align: center;">
					${f:h(e.kaihatsuGroupHeadName)}
				</td>
				<td id="eigyo-name" class="short-emp-name" style="text-align: center;">
					${f:h(e.eigyoName)}
				</td>
				<td id="hattyu-type-name" class="hattyu-type" style="text-align: center;">
					${f:h(e.hattyuTypeName)}
				</td>
				<td id="hattyu-mikomi-date" class="date" style="text-align: right; padding-right: 5px;">
					${f:h(e.hattyuMikomiDate)}
				</td>
				<td id="hattyu-date" class="date" style="text-align: right; padding-right: 5px;">
					${f:h(e.hattyuDate)}
				</td>
				<td id="kensyu-date" class="date" style="text-align: right; padding-right: 5px;">
					${f:h(e.kensyuDate)}
				</td>
				<td id="kakudo-name" class="jokyo" style="text-align: center;">
					${f:h(e.kakudoName)}
				</td>
				<td id="theme-no" class="theme-no" style="text-align: center;">
					${f:h(e.themeNo)}
				</td>
				<td id="theme-group" class="theme-group" style="text-align: center;">
					${f:h(e.themeGroup)}
				</td>
				<td id="jutyugaku" class="money" style="text-align: right; padding-right: 5px;">
					¥ <fmt:formatNumber value="${f:h(e.jutyugaku)}" />
				</td>
				<td id="uriage-total" class="money" style="text-align: right; padding-right: 5px;">
				</td>

				<c:if test="${!empty e.tounendoApr}">
					<td id="tounendo-apr" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoApr)}" />
					</td>
					<td id="tounendo-may" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoMay)}" />
					</td>
					<td id="tounendo-jun" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoJun)}" />
					</td>
					<td id="tounendo-jul" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoJul)}" />
					</td>
					<td id="tounendo-aug" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoAug)}" />
					</td>
					<td id="tounendo-sep" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoSep)}" />
					</td>
					<td id="tounendo-kamiki" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoKamiki)}" />
					</td>
					<td id="tounendo-oct" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoOct)}" />
					</td>
					<td id="tounendo-nov" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoNov)}" />
					</td>
					<td id="tounendo-dec" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoDec)}" />
					</td>
					<td id="tounendo-jan" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoJan)}" />
					</td>
					<td id="tounendo-feb" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoFeb)}" />
					</td>
					<td id="tounendo-mar" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoMar)}" />
					</td>
					<td id="tounendo-shimoki" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoShimoki)}" />
					</td>
					<td id="tounendo-total" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.tounendoTotal)}" />
					</td>

				</c:if>
				<c:if test="${empty e.tounendoApr}">
					<td colspan="15"></td>
				</c:if>

				<c:if test="${!empty e.jinendoApr}">
					<td id="jinendo-apr" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoApr)}" />
					</td>
					<td id="jinendo-may" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoMay)}" />
					</td>
					<td id="jinendo-jun" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoJun)}" />
					</td>
					<td id="jinendo-jul" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoJul)}" />
					</td>
					<td id="jinendo-aug" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoAug)}" />
					</td>
					<td id="jinendo-sep" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoSep)}" />
					</td>
					<td id="jinendo-kamiki" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoKamiki)}" />
					</td>
					<td id="jinendo-oct" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoOct)}" />
					</td>
					<td id="jinendo-nov" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoNov)}" />
					</td>
					<td id="jinendo-dec" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoDec)}" />
					</td>
					<td id="jinendo-jan" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoJan)}" />
					</td>
					<td id="jinendo-feb" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoFeb)}" />
					</td>
					<td id="jinendo-mar" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoMar)}" />
					</td>
					<td id="jinendo-shimoki" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoShimoki)}" />
					</td>
					<td id="jinendo-total" class="money" style="text-align: right; padding-right: 5px;">
						¥ <fmt:formatNumber value="${f:h(e.jinendoTotal)}" />
					</td>
				</c:if>
				<c:if test="${empty e.jinendoApr}">
					<td colspan="15"></td>
				</c:if>

				<td id="uk-yokuyoku" class="money" style="text-align: right; padding-right: 5px;">
					¥ <fmt:formatNumber value="${f:h(e.ukYokuyoku)}" />
				</td>
				<td id="notes" class="notes" style="text-align: left; padding-left: 5px;">
					${f:h(e.notes)}
				</td>

		</tr>
		</s:form>
	</c:forEach>
</table>
</div>
</body>
</html>